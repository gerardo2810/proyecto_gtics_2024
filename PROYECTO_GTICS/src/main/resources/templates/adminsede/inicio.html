<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec = "http://www.thymeleaf.org/extras/spring-security">    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <link rel="icon" type="image/x-icon" th:href="@{/media/favicon.png}">

        <!--=============== REMIXICONS ===============-->
        <link href="https://cdn.jsdelivr.net/npm/remixicon@3.2.0/fonts/remixicon.css" rel="stylesheet">
        <!--=============== CSS ===============-->
        <link rel="stylesheet" th:href="@{/css/adminsede/indexstyle.css}">
        <link rel="stylesheet" th:href="@{/css/adminsede/graficos.css}">
        <link rel="stylesheet" th:href="@{/css/adminsede/tracking.css}">
        <link rel="stylesheet" th:href="@{/css/styles.css}">
        <link rel="stylesheet" th:href="@{/css/fonts.css}">
        <link rel="stylesheet" th:href="@{/css/topbar.css}">
        <link rel="stylesheet" th:href="@{/css/footer.css}">
        <link rel="stylesheet" th:href="@{/css/farmacista/farmacista.css}">
        <link th:href="@{/css/preloader.css}" rel="stylesheet" />
        <link rel="stylesheet" th:href="@{/css/paciente/paciente.css}">
        <link rel="stylesheet" th:href="@{/css/paciente/progress-bar.css}">
        <link rel="stylesheet" th:href="@{/css/scrollbar.css}">

        <!--=============== JS ===============-->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.5.0/echarts.min.js" integrity="sha512-k37wQcV4v2h6jgYf5IUz1MoSKPpDs630XGSmCaCCOXxy2awgAWKHGZWr9nMyGgk3IOxA1NxdkN8r1JHgkUtMoQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script th:src="@{/js/graficos.js}"></script>
        <script th:src="@{/js/tracking.js}"></script>

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
        <!-- Font Awesome -->
        <script src="https://kit.fontawesome.com/a2dd6045c4.js" crossorigin="anonymous"></script>

        <!--=============== SWEETALERT ===============-->
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.7/dist/sweetalert2.all.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.7/dist/sweetalert2.min.css" rel="stylesheet">

        <title>Bienestar San Miguel | Administrador de Sede</title>
    </head>

    <header class="header-topbar">
        <nav th:replace="~{fragments/navbar.html :: navbar( active = 'Inicio')}"></nav>
    </header>

    <body>

        <div style="margin-top: 80px"></div>

        <div class="container">
            <div style="padding-top: 20px; padding-bottom: 20px">
                <div class="main-title open-sans-bold"> Inicio </div>
                <div class="main-subtitle helvetica-medium"> Vista de Estadísticas y Órdenes de reposición</div>
            </div>
            <hr class="style-one">

        </div>

        <div class = "container" th:if="${listaReposicionNoEntregadasUltimas.size() != 0}">
            <div class="container">

                <div style="margin-bottom: 50px"></div>
                <h2><i class="fa-solid fa-star" style="color: #2a2a2a;"></i><strong style="padding-left: 10px; color: #2a2a2a">Tracking órdenes de reposición</strong></h2>
                <div style="margin-bottom: 10px"></div>

                <div style="padding-right: 0; padding-left: 0"> </div>
            </div>
            <br/>
            <div th:each="orden : ${listaReposicionNoEntregadasUltimas}">
                <h2 style="margin-left: 30px" th:text="${'Orden de reposición #' + orden.getNumero()}">Orden de reposicion #1</h2>
                <div class="container-track1" style="margin-left: 30px" th:if="${orden.getEstado().getIdEstado() == 1}">
                    <div class="wrapper">
                        <h3>Estado de la orden</h3>
                        <div class="progress-container" style="margin-top: 60px">
                            <div class="progress" id="progress"></div>
                            <div class="barra"  style="width: 0%"></div>
                            <div class="progress-step" style="margin-right: 50px">
                                <div>
                                    <i class="fa-solid fa-list-ul active"></i>Recibido
                                </div>
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-cart-shopping"></i>En proceso
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-box"></i>Empaquetado
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-truck"></i>En ruta
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-check-double"></i>Entregado
                            </div>

                        </div>
                        <!--
                        <div class="btn-container">
                            <button class="btn" id="prev">Previous</button>
                            <button class="btn" id="next">Next</button>
                        </div>
                        -->
                    </div>

                    <div class = "container-orden">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d9729.08126190579!2d-77.08409606049462!3d-12.060642000613765!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9105c93f68568ff7%3A0xef4f31a29f1c0409!2sPerufarma%20SA!5e0!3m2!1ses!2spe!4v1715203570043!5m2!1ses!2spe" width="100%" height="200" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                </div>

                <div class="container-track1" style="margin-left: 30px" th:if="${orden.getEstado().getIdEstado() == 2}">
                    <div class="wrapper">
                        <h3>Estado de la orden</h3>
                        <div class="progress-container" style="margin-top: 60px">
                            <div class="progress" id="progress"></div>
                            <div class="barra"  style="width: 25%"></div>
                            <div class="progress-step" style="margin-right: 50px">
                                <div>
                                    <i class="fa-solid fa-list-ul active"></i>Recibido
                                </div>
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-cart-shopping active"></i>En proceso
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-box"></i>Empaquetado
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-truck"></i>En ruta
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-check-double"></i>Entregado
                            </div>

                        </div>
                        <!--
                        <div class="btn-container">
                            <button class="btn" id="prev">Previous</button>
                            <button class="btn" id="next">Next</button>
                        </div>
                        -->
                    </div>

                    <div class = "container-orden">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3901.575971232228!2d-77.07181742216821!3d-12.072669257653358!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9105c91a6f8fbefb%3A0x408ed032eafa9864!2sMultilab%20Pueblo%20Libre!5e0!3m2!1ses!2spe!4v1712592591241!5m2!1ses!2spe" width="100%" height="200" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                </div>


                <div class="container-track1" style="margin-left: 30px" th:if="${orden.getEstado().getIdEstado() == 3}">
                    <div class="wrapper">
                        <h3>Estado de la orden</h3>
                        <div class="progress-container" style="margin-top: 60px">
                            <div class="progress" id="progress"></div>
                            <div class="barra"  style="width: 50%"></div>
                            <div class="progress-step" style="margin-right: 50px">
                                <div>
                                    <i class="fa-solid fa-list-ul active"></i>Recibido
                                </div>
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-cart-shopping active"></i>En proceso
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-box active"></i>Empaquetado
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-truck"></i>En ruta
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-check-double"></i>Entregado
                            </div>

                        </div>
                        <!--
                        <div class="btn-container">
                            <button class="btn" id="prev">Previous</button>
                            <button class="btn" id="next">Next</button>
                        </div>
                        -->
                    </div>

                    <div class = "container-orden">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3901.575971232228!2d-77.07181742216821!3d-12.072669257653358!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9105c91a6f8fbefb%3A0x408ed032eafa9864!2sMultilab%20Pueblo%20Libre!5e0!3m2!1ses!2spe!4v1712592591241!5m2!1ses!2spe" width="100%" height="200" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                </div>

                <div class="container-track1" style="margin-left: 30px" th:if="${orden.getEstado().getIdEstado() == 4}">
                    <div class="wrapper">
                        <div><h3>Estado de la orden</h3></div>
                        <div class="progress-container" style="margin-top: 60px">
                            <div class="progress" id="progress"></div>
                            <div class="barra"  style="width: 70%"></div>
                            <div class="progress-step" style="margin-right: 50px">
                                <div>
                                    <i class="fa-solid fa-list-ul active"></i>Recibido
                                </div>
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-cart-shopping active"></i>En proceso
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-box active"></i>Empaquetado
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-truck active"></i>En ruta
                            </div>
                            <div class="progress-step" style="margin-right: 50px">
                                <i class="fa-solid fa-check-double"></i>Entregado
                            </div>

                        </div>
                        <!--
                        <div class="btn-container">
                            <button class="btn" id="prev">Previous</button>
                            <button class="btn" id="next">Next</button>
                        </div>
                        -->
                    </div>

                    <div class = "container-orden">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2510.0212800227946!2d-77.07316603547278!3d-12.071501581470043!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9105c9113be95ead%3A0x105200a1cc20f03b!2sAvenida%20Simon%20Bolivar!5e0!3m2!1ses!2spe!4v1715203288656!5m2!1ses!2spe" width="100%" height="200" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                </div>
            </div>
            <br/><br/>


            <div class="container-graph-circular">
                <button class="btn-p" type="button" onclick="window.location.href = '/adminsede/ordenes'" style="margin-left: 20px">Ver más</button>
            </div>

        </div>
        <div class="container">

            <div style="margin-bottom: 50px"></div>
            <h2><i class="fa-solid fa-star" style="color: #2a2a2a; margin-left: 33px"></i><strong style="padding-left: 10px; color: #2a2a2a">Estadísticas</strong></h2>
            <div style="margin-bottom: 40px"></div>

            <div style="padding-right: 0; padding-left: 0"> </div>
        </div>
        <br/>

        <div class="container-track1">
            <div class = "container-graph">
                <h2>Medicamentos con poco inventario</h2>

                <div id="chart1" class="chart"></div>

            </div>
        </div>

        <div class="container-track1">
            <div class = "container-graph">
                <h2>Medicamentos más solicitados</h2>

                <div id="chart2" class="chart"></div>

            </div>
        </div>

        <div class="container-graph-circular">

            <div class = "container-graph">
                <h2>Cantidad de transacciones de medicamentos por sede</h2>

                <div id="chart4" class="chart"></div>

            </div>
        </div>

        <!--Footer -->
        <br/>
        <div th:replace="~{fragments/navbar.html :: footer}">
        </div>

        <script>
            $(document).ready(function() {
                var opened = false;

                $('#menu-small').hide();

                $('#nav-toggle').click(function (e) {
                    e.stopPropagation();
                    if (opened) {
                        $('#menu-small').hide();
                    } else {
                        $('#menu-small').show();
                    }
                    opened = !opened;
                });
            });
        </script>
        <!-- Para lista1 -->
        <div th:each="item : ${lista1}" class="lista1-item">
            <!-- Contenido de la lista -->
        </div>

        <!-- Para lista2 -->
        <div th:each="item : ${lista2}" class="lista2-item">
            <!-- Contenido de la lista -->
        </div>

        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Obtener el número de elementos en las listas
                var lista1Count = document.querySelectorAll('.lista1-item').length;
                var lista2Count = document.querySelectorAll('.lista2-item').length;

                // Verificar si alguna de las listas tiene elementos
                if (lista1Count > 0 || lista2Count > 0) {
                    // Mostrar la alerta
                    Swal.fire({
                        title: '¡Atención!',
                        text: 'Su inventario de medicamentos se está agotando. Por favor, revise su stock y realice los pedidos necesarios para evitar interrupciones en el servicio.',
                        icon: 'warning',
                        confirmButtonText: 'Entendido',
                        showCancelButton: true,
                        cancelButtonText: 'Ir a revisar',
                    }).then((result) => {
                        if (result.isConfirmed) {
                            // El usuario hizo clic en 'Entendido'
                            // Puedes agregar acciones adicionales aquí si es necesario
                        } else if (result.dismiss === Swal.DismissReason.cancel) {
                            // El usuario hizo clic en 'Ir a revisar'
                            // Redirigir a otra vista
                            window.location.href = '/adminsede/notificaciones_adminsede';
                        }
                    });
                }
            });

        </script>



    </body>
</html>